<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard - StackIt ‚Äì A Minimal Q&A Forum Platform</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="leaderboard.css">
</head>
<body>
    <div class="leaderboard-container">
        <!-- Header -->
        <header class="leaderboard-header">
            <div class="header-content">
                <div class="header-left">
                    <button class="back-btn" id="backBtn">
                        <span>‚Üê</span>
                    </button>
                    <h1>üèÜ Weekly Leaderboard</h1>
                </div>
                <div class="header-right">
                    <div class="search-container">
                        <span class="search-icon">üîç</span>
                        <input type="text" placeholder="Search questions..." class="search-input" id="searchInput">
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="leaderboard-main">
            <!-- Stats Summary -->
            <section class="stats-summary">
                <div class="stat-card">
                    <div class="stat-number">5</div>
                    <div class="stat-label">Top Questions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15</div>
                    <div class="stat-label">Total Votes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">6</div>
                    <div class="stat-label">Total Answers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">45</div>
                    <div class="stat-label">Total Views</div>
                </div>
            </section>

            <!-- Leaderboard List -->
            <section class="leaderboard-section">
                <div class="section-header">
                    <h2>Top Voted Questions This Week</h2>
                    <p>Most upvoted questions from the developer community</p>
                </div>
                
                <!-- Filter Controls -->
                <div class="filter-controls">
                    <div class="filter-group">
                        <label for="sortSelect">Sort by:</label>
                        <select id="sortSelect" class="sort-select">
                            <option value="votes">Most Votes</option>
                            <option value="answers">Most Answers</option>
                            <option value="views">Most Views</option>
                            <option value="recent">Most Recent</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="tagFilter">Filter by tag:</label>
                        <select id="tagFilter" class="tag-filter">
                            <option value="">All Tags</option>
                            <option value="javascript">JavaScript</option>
                            <option value="react">React</option>
                            <option value="python">Python</option>
                            <option value="nodejs">Node.js</option>
                            <option value="css">CSS</option>
                        </select>
                    </div>
                </div>

                <!-- Questions List -->
                <div class="questions-list" id="questionsList">
                    <!-- Questions will be populated by JavaScript -->
                </div>

                <!-- Pagination -->
                <div class="pagination-container">
                    <div class="pagination-info">
                        Showing <span id="startIndex">1</span> - <span id="endIndex">10</span> of <span id="totalQuestions">50</span> questions
                    </div>
                    <div class="pagination" id="pagination">
                        <!-- Pagination buttons will be generated by JavaScript -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Sample data for 50 questions
        const allQuestions = [
            {
                id: 1,
                rank: 1,
                title: "How to implement infinite scrolling in React with TypeScript?",
                author: "Divyansh Nagpal",
                votes: 4,
                upvotes: 4,
                downvotes: 0,
                answers: 2,
                views: 8,
                tags: ["react", "typescript", "infinite-scroll"],
                time: "1 hour ago"
            },
            {
                id: 2,
                rank: 2,
                title: "Best practices for state management in large React applications?",
                author: "Saurabh Jha",
                votes: 8,
                upvotes: 8,
                downvotes: 0,
                answers: 1,
                views: 5,
                tags: ["react", "state-management", "best-practices"],
                time: "2 hours ago"
            },
            {
                id: 3,
                rank: 3,
                title: "How to optimize performance in Node.js applications?",
                author: "Himnish Ahuja",
                votes: 6,
                upvotes: 6,
                downvotes: 0,
                answers: 1,
                views: 4,
                tags: ["nodejs", "performance", "optimization"],
                time: "2 hours ago"
            },
            {
                id: 4,
                rank: 4,
                title: "CSS Grid vs Flexbox: When to use which?",
                author: "Divyansh Rai",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 4,
                tags: ["css", "grid", "flexbox"],
                time: "3 hours ago"
            },
            {
                id: 5,
                rank: 5,
                title: "How to implement authentication with JWT in Express.js?",
                author: "Saharand Joshi",
                votes: 5,
                upvotes: 5,
                downvotes: 0,
                answers: 2,
                views: 9,
                tags: ["express", "jwt", "authentication"],
                time: "3 hours ago"
            },
            {
                id: 6,
                rank: 6,
                title: "Understanding async/await vs Promises in JavaScript",
                author: "Janah Singh",
                votes: 3,
                upvotes: 3,
                downvotes: 0,
                answers: 1,
                views: 9,
                tags: ["javascript", "async", "promises"],
                time: "3 hours ago"
            },
            {
                id: 7,
                rank: 7,
                title: "How to deploy a React app to AWS S3 with GitHub Actions?",
                author: "Arun",
                votes: 4,
                upvotes: 4,
                downvotes: 0,
                answers: 1,
                views: 7,
                tags: ["react", "aws", "github-actions", "deployment"],
                time: "3 hours ago"
            },
            {
                id: 8,
                rank: 8,
                title: "Implementing dark mode toggle in React with CSS variables",
                author: "Ashmit Singh",
                votes: 4,
                upvotes: 4,
                downvotes: 0,
                answers: 1,
                views: 6,
                tags: ["react", "css", "dark-mode"],
                time: "3 hours ago"
            },
            {
                id: 9,
                rank: 9,
                title: "What are the differences between let, const, and var in JavaScript?",
                author: "Himnish Ahuja",
                votes: 3,
                upvotes: 3,
                downvotes: 0,
                answers: 1,
                views: 6,
                tags: ["javascript", "variables", "scope"],
                time: "3 hours ago"
            },
            {
                id: 10,
                rank: 10,
                title: "How to handle errors in async functions properly?",
                author: "Saharand Joshi",
                votes: 3,
                upvotes: 3,
                downvotes: 0,
                answers: 1,
                views: 5,
                tags: ["javascript", "async", "error-handling"],
                time: "3 hours ago"
            },
            // Adding more questions to reach 50
            {
                id: 11,
                rank: 11,
                title: "React Hooks: useState vs useReducer for complex state",
                author: "Janah Singh",
                votes: 3,
                upvotes: 3,
                downvotes: 0,
                answers: 1,
                views: 5,
                tags: ["react", "hooks", "state"],
                time: "3 hours ago"
            },
            {
                id: 12,
                rank: 12,
                title: "How to implement real-time features with WebSockets?",
                author: "Saharand Joshi",
                votes: 3,
                upvotes: 3,
                downvotes: 0,
                answers: 1,
                views: 5,
                tags: ["websockets", "realtime", "javascript"],
                time: "3 hours ago"
            },
            {
                id: 13,
                rank: 13,
                title: "CSS animations and transitions best practices",
                author: "Ashmit Singh",
                votes: 3,
                upvotes: 3,
                downvotes: 0,
                answers: 1,
                views: 4,
                tags: ["css", "animations", "transitions"],
                time: "3 hours ago"
            },
            {
                id: 14,
                rank: 14,
                title: "How to optimize images for web performance?",
                author: "Himnish Ahuja",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 4,
                tags: ["performance", "images", "web"],
                time: "3 hours ago"
            },
            {
                id: 15,
                rank: 15,
                title: "Understanding JavaScript closures and scope",
                author: "Janah Singh",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 4,
                tags: ["javascript", "closures", "scope"],
                time: "3 hours ago"
            },
            {
                id: 16,
                rank: 16,
                title: "How to implement responsive design with CSS Grid?",
                author: "Saharand Joshi",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 3,
                tags: ["css", "grid", "responsive"],
                time: "3 hours ago"
            },
            {
                id: 17,
                rank: 17,
                title: "React performance optimization techniques",
                author: "Arun",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 3,
                tags: ["react", "performance", "optimization"],
                time: "3 hours ago"
            },
            {
                id: 18,
                rank: 18,
                title: "How to handle form validation in React?",
                author: "Ashmit Singh",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 3,
                tags: ["react", "forms", "validation"],
                time: "3 hours ago"
            },
            {
                id: 19,
                rank: 19,
                title: "Understanding JavaScript event loop and callbacks",
                author: "event_loop",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 3,
                tags: ["javascript", "event-loop", "callbacks"],
                time: "3 hours ago"
            },
            {
                id: 20,
                rank: 20,
                title: "How to implement lazy loading in React?",
                author: "lazy_loader",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 2,
                tags: ["react", "lazy-loading", "performance"],
                time: "3 hours ago"
            },
            // Continue with more questions...
            {
                id: 21,
                rank: 21,
                title: "CSS custom properties (variables) best practices",
                author: "css_vars",
                votes: 2,
                upvotes: 2,
                downvotes: 0,
                answers: 1,
                views: 2,
                tags: ["css", "variables", "custom-properties"],
                time: "3 hours ago"
            },
            {
                id: 22,
                rank: 22,
                title: "How to implement pagination in React?",
                author: "pagination_dev",
                votes: 162,
                answers: 4,
                views: 240,
                tags: ["react", "pagination", "ui"],
                time: "1 week ago"
            },
            {
                id: 23,
                rank: 23,
                title: "Understanding JavaScript prototypes and inheritance",
                author: "proto_expert",
                votes: 150,
                answers: 8,
                views: 220,
                tags: ["javascript", "prototypes", "inheritance"],
                time: "1 week ago"
            },
            {
                id: 24,
                rank: 24,
                title: "How to implement search functionality in React?",
                author: "search_dev",
                votes: 138,
                answers: 5,
                views: 200,
                tags: ["react", "search", "filtering"],
                time: "1 week ago"
            },
            {
                id: 25,
                rank: 25,
                title: "CSS Flexbox complete guide",
                author: "flexbox_guru",
                votes: 126,
                answers: 7,
                views: 180,
                tags: ["css", "flexbox", "layout"],
                time: "1 week ago"
            },
            {
                id: 26,
                rank: 26,
                title: "How to handle API calls in React with hooks?",
                author: "api_hooker",
                votes: 114,
                answers: 6,
                views: 160,
                tags: ["react", "api", "hooks"],
                time: "1 week ago"
            },
            {
                id: 27,
                rank: 27,
                title: "JavaScript array methods you should know",
                author: "array_master",
                votes: 102,
                answers: 9,
                views: 140,
                tags: ["javascript", "arrays", "methods"],
                time: "1 week ago"
            },
            {
                id: 28,
                rank: 28,
                title: "How to implement drag and drop in React?",
                author: "drag_dropper",
                votes: 90,
                answers: 4,
                views: 120,
                tags: ["react", "drag-drop", "ui"],
                time: "1 week ago"
            },
            {
                id: 29,
                rank: 29,
                title: "CSS positioning techniques explained",
                author: "position_expert",
                votes: 78,
                answers: 5,
                views: 100,
                tags: ["css", "positioning", "layout"],
                time: "1 week ago"
            },
            {
                id: 30,
                rank: 30,
                title: "How to implement infinite scroll in vanilla JavaScript?",
                author: "vanilla_scroll",
                votes: 66,
                answers: 3,
                views: 80,
                tags: ["javascript", "infinite-scroll", "vanilla"],
                time: "1 week ago"
            },
            {
                id: 31,
                rank: 31,
                title: "React Context API vs Redux: When to use which?",
                author: "context_redux",
                votes: 54,
                answers: 7,
                views: 70,
                tags: ["react", "context", "redux"],
                time: "1 week ago"
            },
            {
                id: 32,
                rank: 32,
                title: "How to implement file upload in React?",
                author: "file_uploader",
                votes: 42,
                answers: 4,
                views: 60,
                tags: ["react", "file-upload", "forms"],
                time: "1 week ago"
            },
            {
                id: 33,
                rank: 33,
                title: "CSS animations performance optimization",
                author: "anim_perf",
                votes: 30,
                answers: 3,
                views: 50,
                tags: ["css", "animations", "performance"],
                time: "1 week ago"
            },
            {
                id: 34,
                rank: 34,
                title: "How to implement virtual scrolling in React?",
                author: "virtual_scroll",
                votes: 28,
                answers: 2,
                views: 40,
                tags: ["react", "virtual-scroll", "performance"],
                time: "1 week ago"
            },
            {
                id: 35,
                rank: 35,
                title: "JavaScript memory management best practices",
                author: "memory_guru",
                votes: 26,
                answers: 5,
                views: 35,
                tags: ["javascript", "memory", "performance"],
                time: "1 week ago"
            },
            {
                id: 36,
                rank: 36,
                title: "How to implement progressive web app features?",
                author: "pwa_dev",
                votes: 24,
                answers: 4,
                views: 30,
                tags: ["pwa", "progressive-web-app", "service-workers"],
                time: "1 week ago"
            },
            {
                id: 37,
                rank: 37,
                title: "CSS Grid layout patterns",
                author: "grid_patterns",
                votes: 22,
                answers: 3,
                views: 25,
                tags: ["css", "grid", "patterns"],
                time: "1 week ago"
            },
            {
                id: 38,
                rank: 38,
                title: "How to implement real-time chat in React?",
                author: "chat_dev",
                votes: 20,
                answers: 2,
                views: 20,
                tags: ["react", "chat", "realtime"],
                time: "1 week ago"
            },
            {
                id: 39,
                rank: 39,
                title: "JavaScript debugging techniques and tools",
                author: "debug_master",
                votes: 18,
                answers: 4,
                views: 18,
                tags: ["javascript", "debugging", "tools"],
                time: "1 week ago"
            },
            {
                id: 40,
                rank: 40,
                title: "How to implement accessibility in React apps?",
                author: "a11y_dev",
                votes: 16,
                answers: 3,
                views: 16,
                tags: ["react", "accessibility", "a11y"],
                time: "1 week ago"
            },
            {
                id: 41,
                rank: 41,
                title: "CSS preprocessors: Sass vs Less vs Stylus",
                author: "preprocessor",
                votes: 14,
                answers: 2,
                views: 14,
                tags: ["css", "sass", "less", "stylus"],
                time: "1 week ago"
            },
            {
                id: 42,
                rank: 42,
                title: "How to implement internationalization in React?",
                author: "i18n_dev",
                votes: 12,
                answers: 2,
                views: 12,
                tags: ["react", "i18n", "internationalization"],
                time: "1 week ago"
            },
            {
                id: 43,
                rank: 43,
                title: "JavaScript testing strategies and tools",
                author: "test_master",
                votes: 10,
                answers: 3,
                views: 10,
                tags: ["javascript", "testing", "tools"],
                time: "1 week ago"
            },
            {
                id: 44,
                rank: 44,
                title: "How to implement data visualization in React?",
                author: "viz_dev",
                votes: 8,
                answers: 2,
                views: 8,
                tags: ["react", "data-visualization", "charts"],
                time: "1 week ago"
            },
            {
                id: 45,
                rank: 45,
                title: "CSS architecture and methodology",
                author: "css_architect",
                votes: 6,
                answers: 2,
                views: 6,
                tags: ["css", "architecture", "methodology"],
                time: "1 week ago"
            },
            {
                id: 46,
                rank: 46,
                title: "How to implement micro-interactions in React?",
                author: "micro_interactions",
                votes: 4,
                answers: 1,
                views: 4,
                tags: ["react", "micro-interactions", "ui"],
                time: "1 week ago"
            },
            {
                id: 47,
                rank: 47,
                title: "JavaScript security best practices",
                author: "security_expert",
                votes: 3,
                answers: 2,
                views: 3,
                tags: ["javascript", "security", "best-practices"],
                time: "1 week ago"
            },
            {
                id: 48,
                rank: 48,
                title: "How to implement voice commands in web apps?",
                author: "voice_dev",
                votes: 2,
                answers: 1,
                views: 2,
                tags: ["voice", "web-speech", "accessibility"],
                time: "1 week ago"
            },
            {
                id: 49,
                rank: 49,
                title: "CSS custom properties advanced usage",
                author: "css_advanced",
                votes: 1,
                answers: 1,
                views: 1,
                tags: ["css", "custom-properties", "advanced"],
                time: "1 week ago"
            },
            {
                id: 50,
                rank: 50,
                title: "How to implement blockchain features in web apps?",
                author: "blockchain_dev",
                votes: 1,
                answers: 1,
                views: 1,
                tags: ["blockchain", "web3", "cryptocurrency"],
                time: "1 week ago"
            }
        ];

        // Generate upvotes and downvotes for questions that don't have them
        allQuestions.forEach(question => {
            if (!question.upvotes || !question.downvotes) {
                // Generate realistic upvotes and downvotes based on total votes
                const totalVotes = question.votes;
                const upvoteRatio = 0.85 + (Math.random() * 0.1); // 85-95% upvote ratio
                question.upvotes = Math.round(totalVotes * upvoteRatio);
                question.downvotes = Math.max(0, totalVotes - question.upvotes);
            }
        });

        // Pagination settings
        const questionsPerPage = 10;
        let currentPage = 1;
        let filteredQuestions = [...allQuestions];

        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication
            if (localStorage.getItem('userLoggedIn') !== 'true') {
                window.location.href = 'login.html';
                return;
            }

            // Initialize bookmark states
            initializeBookmarkStates();

            // Initialize the page
            renderQuestions();
            renderPagination();
            updatePaginationInfo();

            // Event listeners
            document.getElementById('backBtn').addEventListener('click', () => {
                window.location.href = 'home.html';
            });

            document.getElementById('searchInput').addEventListener('input', handleSearch);
            document.getElementById('sortSelect').addEventListener('change', handleSort);
            document.getElementById('tagFilter').addEventListener('change', handleFilter);
        });

        function renderQuestions() {
            const questionsList = document.getElementById('questionsList');
            const startIndex = (currentPage - 1) * questionsPerPage;
            const endIndex = startIndex + questionsPerPage;
            const pageQuestions = filteredQuestions.slice(startIndex, endIndex);

            questionsList.innerHTML = pageQuestions.map(question => `
                <div class="leaderboard-item" data-question-id="${question.id}">
                    <div class="rank-badge rank-${question.rank <= 3 ? question.rank : 'other'}">${question.rank}</div>
                    <div class="question-info">
                        <h3 class="question-title">
                            <a href="#" onclick="openQuestion(${question.id})">${question.title}</a>
                        </h3>
                        <div class="question-meta">
                            <span class="author">üë§ ${question.author}</span>
                            <span class="votes">üëç ${question.votes.toLocaleString()} votes</span>
                            <span class="time">${question.time}</span>
                            <button class="bookmark-btn" data-question-id="${question.id}" onclick="toggleBookmark(${question.id})">
                                <span class="bookmark-icon"></span>
                            </button>
                        </div>
                        <div class="vote-breakdown">
                            <span class="upvotes">‚ñ≤ ${question.upvotes.toLocaleString()}</span>
                            <span class="downvotes">‚ñº ${question.downvotes.toLocaleString()}</span>
                        </div>
                        <div class="question-tags">
                            ${question.tags.map(tag => `<a href="#" class="tag" onclick="filterByTag('${tag}')">${tag}</a>`).join('')}
                        </div>
                    </div>
                    <div class="question-stats">
                        <div class="stat">
                            <span class="stat-number">${question.answers}</span>
                            <span class="stat-label">answers</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">${question.views.toLocaleString()}</span>
                            <span class="stat-label">views</span>
                        </div>
                    </div>
                </div>
            `).join('');

            // Add click handlers for questions
            document.querySelectorAll('.leaderboard-item').forEach(item => {
                item.addEventListener('click', function() {
                    const questionId = this.dataset.questionId;
                    openQuestion(questionId);
                });
            });
        }

        function renderPagination() {
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(filteredQuestions.length / questionsPerPage);
            
            let paginationHTML = '';
            
            // Previous button
            paginationHTML += `
                <button class="pagination-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                    ‚Üê Previous
                </button>
            `;

            // Page numbers
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            if (startPage > 1) {
                paginationHTML += `
                    <button class="pagination-btn" onclick="changePage(1)">1</button>
                    ${startPage > 2 ? '<span class="pagination-ellipsis">...</span>' : ''}
                `;
            }

            for (let i = startPage; i <= endPage; i++) {
                paginationHTML += `
                    <button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">
                        ${i}
                    </button>
                `;
            }

            if (endPage < totalPages) {
                paginationHTML += `
                    ${endPage < totalPages - 1 ? '<span class="pagination-ellipsis">...</span>' : ''}
                    <button class="pagination-btn" onclick="changePage(${totalPages})">${totalPages}</button>
                `;
            }

            // Next button
            paginationHTML += `
                <button class="pagination-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                    Next ‚Üí
                </button>
            `;

            pagination.innerHTML = paginationHTML;
        }

        function updatePaginationInfo() {
            const startIndex = (currentPage - 1) * questionsPerPage + 1;
            const endIndex = Math.min(currentPage * questionsPerPage, filteredQuestions.length);
            
            document.getElementById('startIndex').textContent = startIndex;
            document.getElementById('endIndex').textContent = endIndex;
            document.getElementById('totalQuestions').textContent = filteredQuestions.length;
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredQuestions.length / questionsPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderQuestions();
                renderPagination();
                updatePaginationInfo();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            filteredQuestions = allQuestions.filter(question => 
                question.title.toLowerCase().includes(searchTerm) ||
                question.author.toLowerCase().includes(searchTerm) ||
                question.tags.some(tag => tag.toLowerCase().includes(searchTerm))
            );
            currentPage = 1;
            renderQuestions();
            renderPagination();
            updatePaginationInfo();
        }

        function handleSort() {
            const sortBy = document.getElementById('sortSelect').value;
            filteredQuestions.sort((a, b) => {
                switch (sortBy) {
                    case 'votes':
                        return b.votes - a.votes;
                    case 'answers':
                        return b.answers - a.answers;
                    case 'views':
                        return b.views - a.views;
                    case 'recent':
                        return new Date(b.time) - new Date(a.time);
                    default:
                        return b.votes - a.votes;
                }
            });
            currentPage = 1;
            renderQuestions();
            renderPagination();
            updatePaginationInfo();
        }

        function handleFilter() {
            const selectedTag = document.getElementById('tagFilter').value;
            if (selectedTag) {
                filteredQuestions = allQuestions.filter(question => 
                    question.tags.includes(selectedTag)
                );
            } else {
                filteredQuestions = [...allQuestions];
            }
            currentPage = 1;
            renderQuestions();
            renderPagination();
            updatePaginationInfo();
        }

        function filterByTag(tag) {
            document.getElementById('tagFilter').value = tag;
            handleFilter();
        }

        function openQuestion(questionId) {
            console.log('Opening question:', questionId);
            // Navigate to question detail page with referrer information
            window.location.href = `question-detail.html?id=${questionId}&from=leaderboard`;
        }

        // Bookmark functionality
        function toggleBookmark(questionId) {
            const bookmarkBtn = document.querySelector(`[data-question-id="${questionId}"].bookmark-btn`);
            const questionItem = document.querySelector(`[data-question-id="${questionId}"].leaderboard-item`);
            
            if (bookmarkBtn.classList.contains('bookmarked')) {
                // Remove bookmark
                bookmarkBtn.classList.remove('bookmarked');
                if (questionItem) questionItem.classList.remove('bookmarked');
                removeBookmarkFromStorage(questionId);
                console.log('Bookmark removed for question:', questionId);
            } else {
                // Add bookmark
                bookmarkBtn.classList.add('bookmarked');
                if (questionItem) questionItem.classList.add('bookmarked');
                addBookmarkToStorage(questionId);
                console.log('Bookmark added for question:', questionId);
            }
        }

        function initializeBookmarkStates() {
            const bookmarks = JSON.parse(localStorage.getItem('userBookmarks') || '[]');
            bookmarks.forEach(bookmark => {
                const bookmarkBtn = document.querySelector(`[data-question-id="${bookmark.id}"].bookmark-btn`);
                const questionItem = document.querySelector(`[data-question-id="${bookmark.id}"].leaderboard-item`);
                if (bookmarkBtn) {
                    bookmarkBtn.classList.add('bookmarked');
                }
                if (questionItem) {
                    questionItem.classList.add('bookmarked');
                }
            });
        }

        function addBookmarkToStorage(questionId) {
            const bookmarks = JSON.parse(localStorage.getItem('userBookmarks') || '[]');
            const questionData = getQuestionData(questionId);
            if (questionData && !bookmarks.find(b => b.id === questionId)) {
                bookmarks.unshift({
                    ...questionData,
                    bookmarkedAt: new Date().toISOString()
                });
                localStorage.setItem('userBookmarks', JSON.stringify(bookmarks));
            }
        }

        function removeBookmarkFromStorage(questionId) {
            const bookmarks = JSON.parse(localStorage.getItem('userBookmarks') || '[]');
            const filteredBookmarks = bookmarks.filter(b => b.id !== questionId);
            localStorage.setItem('userBookmarks', JSON.stringify(filteredBookmarks));
        }

        function getQuestionData(questionId) {
            // Find the question in the allQuestions array
            return allQuestions.find(q => q.id === questionId);
        }
    </script>
</body>
</html> 